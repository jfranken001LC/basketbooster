!function(i,n){"object"==typeof exports&&"undefined"!=typeof module?n(exports,require("preact"),require("preact/hooks"),require("@preact/signals-core")):"function"==typeof define&&define.amd?define(["exports","preact","preact/hooks","@preact/signals-core"],n):n((i||self).preactSignals={},i.preact,i.preactHooks,i.preactSignalsCore)}(this,function(i,n,t,r){var e,f,o,u="undefined"!=typeof window&&!!window.__PREACT_SIGNALS_DEVTOOLS__,a=[],c=[];r.effect(function(){e=this.N})();function s(i,t){n.options[i]=t.bind(null,n.options[i]||function(){})}function v(i){if(o)o();o=i&&i.S()}function l(i){var e=this,f=i.data,o=useSignal(f);o.value=f;var u=t.useMemo(function(){var i=e,t=e.__v;while(t=t.__)if(t.__c){t.__c.__$f|=4;break}var f=r.computed(function(){var i=o.value.value;return 0===i?0:!0===i?"":i||""}),u=r.computed(function(){return!Array.isArray(f.value)&&!n.isValidElement(f.value)}),a=r.effect(function(){this.N=g;if(u.value){var n=f.value;if(i.__v&&i.__v.__e&&3===i.__v.__e.nodeType)i.__v.__e.data=n}}),c=e.__$u.d;e.__$u.d=function(){a();c.call(this)};return[u,f]},[]),a=u[0],c=u[1];return a.value?c.peek():c.value}l.displayName="ReactiveTextNode";Object.defineProperties(r.Signal.prototype,{constructor:{configurable:!0,value:void 0},type:{configurable:!0,value:l},props:{configurable:!0,get:function(){return{data:this}}},__b:{configurable:!0,value:1}});s("__b",function(i,n){if("string"==typeof n.type){var t,e=n.props;for(var f in e)if("children"!==f){var o=e[f];if(o instanceof r.Signal){if(!t)n.__np=t={};t[f]=o;e[f]=o.peek()}}}i(n)});s("__r",function(i,t){if(t.type!==n.Fragment){v();var e,o=t.__c;if(o){o.__$f&=-2;if(void 0===(e=o.__$u))o.__$u=e=function(i,n){var t;r.effect(function(){t=this},{name:n});t.c=i;return t}(function(){var i;if(u)null==(i=e.y)||i.call(e);o.__$f|=1;o.setState({})},"function"==typeof t.type?t.type.displayName||t.type.name:"")}f=o;v(e)}i(t)});s("__e",function(i,n,t,r){v();f=void 0;i(n,t,r)});s("diffed",function(i,n){v();f=void 0;var t;if("string"==typeof n.type&&(t=n.__e)){var r=n.__np,e=n.props;if(r){var o=t.U;if(o)for(var u in o){var a=o[u];if(void 0!==a&&!(u in r)){a.d();o[u]=void 0}}else{o={};t.U=o}for(var c in r){var s=o[c],l=r[c];if(void 0===s){s=d(t,c,l,e);o[c]=s}else s.o(l,e)}}}i(n)});function d(i,n,t,e){var f=n in i&&void 0===i.ownerSVGElement,o=r.signal(t);return{o:function(i,n){o.value=i;e=n},d:r.effect(function(){this.N=g;var t=o.value.value;if(e[n]!==t){e[n]=t;if(f)i[n]=t;else if(null!=t&&(!1!==t||"-"===n[4]))i.setAttribute(n,t);else i.removeAttribute(n)}})}}s("unmount",function(i,n){if("string"==typeof n.type){var t=n.__e;if(t){var r=t.U;if(r){t.U=void 0;for(var e in r){var f=r[e];if(f)f.d()}}}}else{var o=n.__c;if(o){var u=o.__$u;if(u){o.__$u=void 0;u.d()}}}i(n)});s("__h",function(i,n,t,r){if(r<3||9===r)n.__$f|=2;i(n,t,r)});n.Component.prototype.shouldComponentUpdate=function(i,n){var t=this.__$u,r=t&&void 0!==t.s;for(var e in n)return!0;if(this.__f||"boolean"==typeof this.u&&!0===this.u){var f=2&this.__$f;if(!(r||f||4&this.__$f))return!0;if(1&this.__$f)return!0}else{if(!(r||4&this.__$f))return!0;if(3&this.__$f)return!0}for(var o in i)if("__source"!==o&&i[o]!==this.props[o])return!0;for(var u in this.props)if(!(u in i))return!0;return!1};function useSignal(i,n){return t.useState(function(){return r.signal(i,n)})[0]}var h="undefined"==typeof requestAnimationFrame?setTimeout:function(i){var n=function(){clearTimeout(t);cancelAnimationFrame(r);i()},t=setTimeout(n,35),r=requestAnimationFrame(n)},p=function(i){queueMicrotask(function(){queueMicrotask(i)})};function _(){r.batch(function(){var i;while(i=a.shift())e.call(i)})}function y(){if(1===a.push(this))(n.options.requestAnimationFrame||h)(_)}function b(){r.batch(function(){var i;while(i=c.shift())e.call(i)})}function g(){if(1===c.push(this))(n.options.requestAnimationFrame||p)(b)}i.Signal=r.Signal;i.batch=r.batch;i.computed=r.computed;i.effect=r.effect;i.signal=r.signal;i.untracked=r.untracked;i.useComputed=function(i,n){var e=t.useRef(i);e.current=i;f.__$f|=4;return t.useMemo(function(){return r.computed(function(){return e.current()},n)},[])};i.useSignal=useSignal;i.useSignalEffect=function(i,n){var e=t.useRef(i);e.current=i;t.useEffect(function(){return r.effect(function(){this.N=y;return e.current()},n)},[])}});//# sourceMappingURL=signals.min.js.map
